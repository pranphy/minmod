<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}</title>
    <meta name="description"
        content="{{ with .Description }}{{ . }}{{ else }}{{ if .IsPage }}{{ .Summary }}{{ else }}{{ .Site.Params.description }}{{ end }}{{ end }}">

    <!-- Open Graph / Twitter Card Image Logic -->
    {{ $image := .Params.thumbnail | default "/asset/image/og-thumbnail.jpg" }}
    {{ $imageAbs := $image | absURL }} <!--
        Open Graph -->
    <meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
    <meta property="og:description"
        content="{{ with .Description }}{{ . }}{{ else }}{{ if .IsPage }}{{ .Summary }}{{ else }}{{ .Site.Params.description }}{{ end }}{{ end }}">
    <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
    <meta property="og:url" content="{{ .Permalink }}">
    <meta property="og:image" content="{{ $imageAbs }}">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
    <meta name="twitter:description"
        content="{{ with .Description }}{{ . }}{{ else }}{{ if .IsPage }}{{ .Summary }}{{ else }}{{ .Site.Params.description }}{{ end }}{{ end }}">
    <meta name="twitter:image" content="{{ $imageAbs }}">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;500;600;700&family=Noto+Serif+Devanagari:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/syntax.css">

    {{/* Load custom user CSS files */}}
    {{ $customCssPath := "static/asset/css" }}
    {{ if (fileExists $customCssPath) }}
    {{ range (readDir $customCssPath) }}
    {{ if strings.HasSuffix .Name ".css" }}
    <link rel="stylesheet" href="{{ printf " /asset/css/%s" .Name | relURL }}">
    {{ end }}
    {{ end }}
    {{ end }}
    <script>
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark')
        }
    </script>

    {{- /* Search */}}
    {{- if (eq .Layout `search`) -}}
    <link crossorigin="anonymous" rel="preload" as="fetch" href="../index.json">
    {{- $fastsearch := resources.Get "js/fastsearch.js" | js.Build (dict "params" (dict "fuseOpts"
    site.Params.fuseOpts)) | resources.Minify }}
    {{- $fusejs := resources.Get "js/fuse.basic.min.js" }}
    {{- $license_js := resources.Get "js/license.js" }}
    {{- if not site.Params.assets.disableFingerprinting }}
    {{- $search := (slice $fusejs $fastsearch ) | resources.Concat "assets/js/search.js" | fingerprint }}
    <script defer crossorigin="anonymous" src="{{ $search.RelPermalink }}"
        integrity="{{ $search.Data.Integrity }}"></script>
    {{- else }}
    {{- $search := (slice $fusejs $fastsearch ) | resources.Concat "assets/js/search.js" }}
    <script defer crossorigin="anonymous" src="{{ $search.RelPermalink }}"></script>
    {{- end }}
    {{- end -}}

    {{ if templates.Exists "partials/extend_head.html" }}
    {{ partial "extend_head.html" . }}
    {{ end }}
</head>